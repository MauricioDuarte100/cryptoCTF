#!/usr/bin/env python3
"""
Quick analysis of the RSA parameters
"""
N = 65667982563395257456152578363358687414628050739860770903063206052667362178166666380390723634587933595241827767873104710537142458025201334420236653463444534018710274020834864080096247524541536313609304410859158429347482458882414275205742819080566766561312731091051276328620677195262137013588957713118640118673
c = 58443816925218320329602359198394095572237417576497896076618137604965419783093911328796166409276903249508047338019341719597113848471431947372873538253571717690982768328452282012361099369599755904288363602972252305949989677897650696581947849811037791349546750246816657184156675665729104603485387966759433211643
m_recovered = 8735877396700251089149556068217648266135379022697166610135628018645313082195893549282959108199548376949195313396131139282203413131653118099631814096610068279232298017648155851466014126844426422096201266376728746377412420655022648127985699893286987888667961987858927314199629927714009321

print(f"N bits: {N.bit_length()}")
print(f"N bytes: {(N.bit_length() + 7) // 8}")
print(f"c bits: {c.bit_length()}")
print(f"m_recovered bits: {m_recovered.bit_length()}")
print(f"m_recovered bytes: {(m_recovered.bit_length() + 7) // 8}")
print()

# Un flag de 131 caracteres ASCII comenzando con "RTACTF{" tendría:
sample_flag = b"RTACTF{" + b"x" * 123 + b"}"  # 131 bytes
from Crypto.Util.number import bytes_to_long
sample_m = bytes_to_long(sample_flag)
print(f"Sample 131-byte flag as int bits: {sample_m.bit_length()}")
print(f"Sample flag > N?: {sample_m > N}")
print()

# Qué tan grande puede ser el flag sin exceder N?
max_bytes = (N.bit_length() + 7) // 8
print(f"Max message size that fits in N: {max_bytes} bytes")
print(f"Actual flag size assertion: 131 bytes")
print(f"Difference: {131 - max_bytes} bytes over limit!")
