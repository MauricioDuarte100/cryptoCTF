

# This file was *autogenerated* from the file sage_solver.sage
from sage.all_cmdline import *   # import sage library

_sage_const_21634731856933003169735452642178647637508232926922639676417356091816977384471672689376249580882757193930156301128940033054503309042859139845611437945134986092564611616108745009303518009598387151910455366467043039032355947377344618722993521508853304193548247098646435210196424079656513689544721371174220499686568082989950728581977777849180352180361 = Integer(21634731856933003169735452642178647637508232926922639676417356091816977384471672689376249580882757193930156301128940033054503309042859139845611437945134986092564611616108745009303518009598387151910455366467043039032355947377344618722993521508853304193548247098646435210196424079656513689544721371174220499686568082989950728581977777849180352180361); _sage_const_10896149947527935553077825816622071364973077548678022351082205110263626546375424477280956382311102704844299225555502875124702037214663686104873121921542353070322911926560931344323844350198967094409239865012314649708602461432807766153010660935060416997124464209447069508459786601387021215440723355335011507118508146962533432224040439243286229360126 = Integer(10896149947527935553077825816622071364973077548678022351082205110263626546375424477280956382311102704844299225555502875124702037214663686104873121921542353070322911926560931344323844350198967094409239865012314649708602461432807766153010660935060416997124464209447069508459786601387021215440723355335011507118508146962533432224040439243286229360126); _sage_const_2974416605206632431332911613301389081536576066459780075624719210553112019999381574735539815564432577560946864927142562117883991071103197295583373508765877145059608994024896240420251219074181316054055755363381932049698101539315448832805529921046278129220365145460609570363992617560153978334998412088660368201330429546380177743790566702908212443160 = Integer(2974416605206632431332911613301389081536576066459780075624719210553112019999381574735539815564432577560946864927142562117883991071103197295583373508765877145059608994024896240420251219074181316054055755363381932049698101539315448832805529921046278129220365145460609570363992617560153978334998412088660368201330429546380177743790566702908212443160); _sage_const_28200548108675594741711127688647173118542383318189251577841958615857415552524747877792302265008776748051982781254674600116918516567783637204844268842440264001368201200545979748997113084793324277575876376294203222951895428314196786131217183329046875244460729983604815969807535725100587998553238491135713196074852524738775442553590229121625915430429 = Integer(28200548108675594741711127688647173118542383318189251577841958615857415552524747877792302265008776748051982781254674600116918516567783637204844268842440264001368201200545979748997113084793324277575876376294203222951895428314196786131217183329046875244460729983604815969807535725100587998553238491135713196074852524738775442553590229121625915430429); _sage_const_27660084559884990182013459957689417397713852464666220341426520872184059171674750770957688936767277417745636106116299261474623004314209285327151916105808226871648486979149690145371455816243023069737489716360204808432361263273679301359983930552697681320318161922577591380052338021611137684073918689934623997444986709421563535513572520613268123359158 = Integer(27660084559884990182013459957689417397713852464666220341426520872184059171674750770957688936767277417745636106116299261474623004314209285327151916105808226871648486979149690145371455816243023069737489716360204808432361263273679301359983930552697681320318161922577591380052338021611137684073918689934623997444986709421563535513572520613268123359158); _sage_const_20119475249162077416396857638627557747581212727911731929838730735042026922648350211354670538277728861548055740933004923747258462839704684057991194187013090441791415402300040364180884606823323138809105421545127016753613657687973221091519628359096716460656580868946574075573069978817526799571787512906522188251790664748517306152235744590642923407030 = Integer(20119475249162077416396857638627557747581212727911731929838730735042026922648350211354670538277728861548055740933004923747258462839704684057991194187013090441791415402300040364180884606823323138809105421545127016753613657687973221091519628359096716460656580868946574075573069978817526799571787512906522188251790664748517306152235744590642923407030); _sage_const_9277710388163094622638132620493076418943086548508776627822589112756821030770943458707342557838944497462173121423514249639208397257763673087133572464166054442803457949072685473390496187502360398640358905886089248930227038534407158700636473552411298647208459527921849668664236361489551764643720805304784463451436299579798872023267551081752293342602 = Integer(9277710388163094622638132620493076418943086548508776627822589112756821030770943458707342557838944497462173121423514249639208397257763673087133572464166054442803457949072685473390496187502360398640358905886089248930227038534407158700636473552411298647208459527921849668664236361489551764643720805304784463451436299579798872023267551081752293342602); _sage_const_31158045977124269135407602181143656602962158545302579362536446823604840518596119753005295977785809341913045532725240349545539969280653140519414628705187132022321389751428727439079243486439117780734082395751447709645236914447281361619769421080744636729959026500210605864515201694830145111407222590251128832957172231813701395706417354758554315626820 = Integer(31158045977124269135407602181143656602962158545302579362536446823604840518596119753005295977785809341913045532725240349545539969280653140519414628705187132022321389751428727439079243486439117780734082395751447709645236914447281361619769421080744636729959026500210605864515201694830145111407222590251128832957172231813701395706417354758554315626820); _sage_const_12055966498208922749084355341317455190065977555930326942190470900499710573397286364597785100102658626097154819494365498065452378904589114960059048398023883917554704026832949307191108288334714871854358976503390510343938466659425227647536427580196701935422718990031197769681866481080518026804185304311437027704081241119520019740912986972955608893278 = Integer(12055966498208922749084355341317455190065977555930326942190470900499710573397286364597785100102658626097154819494365498065452378904589114960059048398023883917554704026832949307191108288334714871854358976503390510343938466659425227647536427580196701935422718990031197769681866481080518026804185304311437027704081241119520019740912986972955608893278); _sage_const_17767102403193202218304699442431662915115000676720318662325347222565131380379182512128854589956743252072881997745083910037035908185085681529637286746328665909791274494229763608885145122640713958013701818219726053389611973156883147796462512131639518714837170414174586570308340181287544747042490023777223079740383799985094123384216016337525460261356 = Integer(17767102403193202218304699442431662915115000676720318662325347222565131380379182512128854589956743252072881997745083910037035908185085681529637286746328665909791274494229763608885145122640713958013701818219726053389611973156883147796462512131639518714837170414174586570308340181287544747042490023777223079740383799985094123384216016337525460261356); _sage_const_6979962672620946147919479608753963248551040648763556914009797078823702868338326269303097713924542946353805294572432317526815669729810518545845862740405319661886528745990666800133027458170688035469999979423509823797849460135768432746502510169283956355180475841044794790275513292333641598671173540633541912640750930419720753655927399240016666928184 = Integer(6979962672620946147919479608753963248551040648763556914009797078823702868338326269303097713924542946353805294572432317526815669729810518545845862740405319661886528745990666800133027458170688035469999979423509823797849460135768432746502510169283956355180475841044794790275513292333641598671173540633541912640750930419720753655927399240016666928184); _sage_const_968567188384602518810627932191890143098667694867203398334134968321028429873726916771512992699613773685562527659911443971269281991870703578160884591545053062755617135892855613023377866271402771406594459830004948687855655933540881347294224484016294356462959434533523237665848042117796037893185022070544050577845529425854753569769243925082186348425 = Integer(968567188384602518810627932191890143098667694867203398334134968321028429873726916771512992699613773685562527659911443971269281991870703578160884591545053062755617135892855613023377866271402771406594459830004948687855655933540881347294224484016294356462959434533523237665848042117796037893185022070544050577845529425854753569769243925082186348425); _sage_const_10804728490972629839599688863419012806514649061220912296135529003539879219079527649729698231657469439519564306737249244230105667024389629639509680649295767296583887032523679565132779403935606718429552343516241547007009490112830748960665135338550271076674383315260470807816736729834782534909218344628077421424202840026186555433845798422403022121746 = Integer(10804728490972629839599688863419012806514649061220912296135529003539879219079527649729698231657469439519564306737249244230105667024389629639509680649295767296583887032523679565132779403935606718429552343516241547007009490112830748960665135338550271076674383315260470807816736729834782534909218344628077421424202840026186555433845798422403022121746); _sage_const_12498485841654082927729391332000176077659445321198357998147011067836907101875662377570700406780396596702209507929935292024871538370717484655020356103692818360512792947022456138114688306425559505127082381521905818319542160425873904602554462539850913289414272261611285708108946736990501473240873425025495477923958515790610331967148138452382936603218 = Integer(12498485841654082927729391332000176077659445321198357998147011067836907101875662377570700406780396596702209507929935292024871538370717484655020356103692818360512792947022456138114688306425559505127082381521905818319542160425873904602554462539850913289414272261611285708108946736990501473240873425025495477923958515790610331967148138452382936603218); _sage_const_15122648432351787708910306624658313472637182521203794932014123051222289899019244470866928921239021804842452628277451525745197770636443191364340973030646677140509931467075316189841308905554392194260607580568566230777907627266848011866303687272754202404316594585444944269571620462990956234986783265518586377149743362292802293436359418534788251556161 = Integer(15122648432351787708910306624658313472637182521203794932014123051222289899019244470866928921239021804842452628277451525745197770636443191364340973030646677140509931467075316189841308905554392194260607580568566230777907627266848011866303687272754202404316594585444944269571620462990956234986783265518586377149743362292802293436359418534788251556161); _sage_const_9390969394140749476608257433637980673038793322877784368488394016568066689122081069467764942062767788295165134446781957798192761040267482593446509285966506710250967465155863626183550169814440998827518143373614753079092718069730432284965599249191929694847006205594924579123016195982524862267549617396581868514010670808145661503083427477788852007310 = Integer(9390969394140749476608257433637980673038793322877784368488394016568066689122081069467764942062767788295165134446781957798192761040267482593446509285966506710250967465155863626183550169814440998827518143373614753079092718069730432284965599249191929694847006205594924579123016195982524862267549617396581868514010670808145661503083427477788852007310); _sage_const_3448120089990058648942506124720802559054287900853595928077413267121845853562240438661071849842739096744542360729856930336959306909786071164994924424227597472810030437315793269469209107626604058418914579865114596569805471044423406753603841793865685790424201472892556200956939191504704829837076185223586663769678271230786398186628579741896694763290 = Integer(3448120089990058648942506124720802559054287900853595928077413267121845853562240438661071849842739096744542360729856930336959306909786071164994924424227597472810030437315793269469209107626604058418914579865114596569805471044423406753603841793865685790424201472892556200956939191504704829837076185223586663769678271230786398186628579741896694763290); _sage_const_18346984788037097313933208211401593831381142486125949187310810719353452435960066367300400122474012758772901379594817743384150758266673403964797768097710409271197754019777606678300159841222437507303036990181586991277543643752497915914368855739662665349654824457220475752835093086231999524281968766631421793059375831672491945304978438858273609843862 = Integer(18346984788037097313933208211401593831381142486125949187310810719353452435960066367300400122474012758772901379594817743384150758266673403964797768097710409271197754019777606678300159841222437507303036990181586991277543643752497915914368855739662665349654824457220475752835093086231999524281968766631421793059375831672491945304978438858273609843862); _sage_const_15536226637285228918258369477325177614750622602365663744612630206655934882232943767418215956866017370265704925268062220229799980544347921306584673132700797772216224464594472779976277574740799882055824944919096492605353410260479055271080577804638750314986246739945093908640859610936039728098902317648534567457516922705899992411565397747984639373641 = Integer(15536226637285228918258369477325177614750622602365663744612630206655934882232943767418215956866017370265704925268062220229799980544347921306584673132700797772216224464594472779976277574740799882055824944919096492605353410260479055271080577804638750314986246739945093908640859610936039728098902317648534567457516922705899992411565397747984639373641); _sage_const_7390421955858946980520324391197648428519742542542180214649313755976167028731434527467516638743761149905206141784824025881109303022940936016663976767507286762461144532635141193737153752852837662949732990422844329896494169995959023121814560566954151943130502828298613554945495095777393937554865091153424594585002558590468988138213857560541279869379 = Integer(7390421955858946980520324391197648428519742542542180214649313755976167028731434527467516638743761149905206141784824025881109303022940936016663976767507286762461144532635141193737153752852837662949732990422844329896494169995959023121814560566954151943130502828298613554945495095777393937554865091153424594585002558590468988138213857560541279869379); _sage_const_112425769870463756578217089225356135328048119859480667962834597449680068602100943466981454518737872915541357211292040696818117602877944971282329119425722152594954465048523912850046328259179463209276175774654633020669939217778876585080281354592084141796995567487319604036168491764793360083660437033644270113271674756316467223785525162737617978324 = Integer(112425769870463756578217089225356135328048119859480667962834597449680068602100943466981454518737872915541357211292040696818117602877944971282329119425722152594954465048523912850046328259179463209276175774654633020669939217778876585080281354592084141796995567487319604036168491764793360083660437033644270113271674756316467223785525162737617978324); _sage_const_14347539756149650174830723100234123374889869526922875679139996993685445445424223671192352937444702312667961596673837164454053204749694354027439552310839338758036132687049417439430104024109309773483398069943055157750606445278793355305121294707158877524719404973030888356254655064096763353962301655730593591467233925869661593303855448059155282216743 = Integer(14347539756149650174830723100234123374889869526922875679139996993685445445424223671192352937444702312667961596673837164454053204749694354027439552310839338758036132687049417439430104024109309773483398069943055157750606445278793355305121294707158877524719404973030888356254655064096763353962301655730593591467233925869661593303855448059155282216743); _sage_const_208801597989499293183806750430428348227754832674422753135296252264260064196215293461261054323859098384083896680527340703676125325162028371333562570477104250816805754783624928526323765509312788420195828206450972283160628389270035698781630799270799491345783045145344965977841131336236262613204299016584603298281389366882657789147781311329063347318 = Integer(208801597989499293183806750430428348227754832674422753135296252264260064196215293461261054323859098384083896680527340703676125325162028371333562570477104250816805754783624928526323765509312788420195828206450972283160628389270035698781630799270799491345783045145344965977841131336236262613204299016584603298281389366882657789147781311329063347318); _sage_const_22833162166359546411724656286023136808995433306442236496006005058375986840061424886144757824911202832922228870863654053366054841239665760330228843814383761504457204209161144276494315317663889626543158797934444747362649948195452867353178757072695264078834255164965304924320430338289357222851915434376663414195354820768778950790299361186797669685845 = Integer(22833162166359546411724656286023136808995433306442236496006005058375986840061424886144757824911202832922228870863654053366054841239665760330228843814383761504457204209161144276494315317663889626543158797934444747362649948195452867353178757072695264078834255164965304924320430338289357222851915434376663414195354820768778950790299361186797669685845); _sage_const_31062637879976203219848680788625459931640372465710164935246301671408043653722612043640281575569140157976904578152151070872082575131681817502508001911337557287758449509185833075365323885637346785285590009679703265939177832920087505472236166486790773064989776631541810613488268406348080905611001308366302641990879414342541856115781757850402335170059 = Integer(31062637879976203219848680788625459931640372465710164935246301671408043653722612043640281575569140157976904578152151070872082575131681817502508001911337557287758449509185833075365323885637346785285590009679703265939177832920087505472236166486790773064989776631541810613488268406348080905611001308366302641990879414342541856115781757850402335170059); _sage_const_17988613074740201689589468687659306312690117614826684863597618561450102878110879882811172597408662493899887430064607954837804338369490512526074587514414097978832086598281565708550985634159994858239903349946604781597238802158566721785968741295329861310102549624225945030480597188499641893374152661524898440766955287008666827803327359643522700462744 = Integer(17988613074740201689589468687659306312690117614826684863597618561450102878110879882811172597408662493899887430064607954837804338369490512526074587514414097978832086598281565708550985634159994858239903349946604781597238802158566721785968741295329861310102549624225945030480597188499641893374152661524898440766955287008666827803327359643522700462744); _sage_const_1156011452003477216703794623187783705084864796533399286057162639813836917463879542752819638295306697549486063876018432666789515496552835507994733128345081757389910447481999426686574891632359918562919770610266438217783289633061584953375493517689845599384734501508935942206029649313828593393464817909340959448946736347052497186319345289140586216133 = Integer(1156011452003477216703794623187783705084864796533399286057162639813836917463879542752819638295306697549486063876018432666789515496552835507994733128345081757389910447481999426686574891632359918562919770610266438217783289633061584953375493517689845599384734501508935942206029649313828593393464817909340959448946736347052497186319345289140586216133); _sage_const_15131763737808936003204137072188410323796446534725965923549717751710772316269463896669835538341947154002338825596535234163516609928932518511266230816390571037926544423386287941598776311481017054600577225406091154789797481613532626171211962510429920759067451778809797719815469811660328643189777652766031261042904687711358896144374397480643638074496 = Integer(15131763737808936003204137072188410323796446534725965923549717751710772316269463896669835538341947154002338825596535234163516609928932518511266230816390571037926544423386287941598776311481017054600577225406091154789797481613532626171211962510429920759067451778809797719815469811660328643189777652766031261042904687711358896144374397480643638074496); _sage_const_2683625879777439052129384625517759288806489980533997491814393250166792474776733383216232130383232280811385051710200597135982258193684031753497695563630145320773844741439765259217702400601542482014686895250894592079589773519487223465866199176146638204588836709356949746937034656669802485231742485402576922520335743224943519092403672383686297621981 = Integer(2683625879777439052129384625517759288806489980533997491814393250166792474776733383216232130383232280811385051710200597135982258193684031753497695563630145320773844741439765259217702400601542482014686895250894592079589773519487223465866199176146638204588836709356949746937034656669802485231742485402576922520335743224943519092403672383686297621981); _sage_const_23976878327379595750161358441759880249973515045738547387900168280548413962580221979739404493185430876269646739126718281667930329337975469259720262570335263149961516991625402462913574876404267584350037763006472002439156665085828134136535590154552915308032844709512849647895372139076879967156825351280796766455118936470166268851280218356166618692489 = Integer(23976878327379595750161358441759880249973515045738547387900168280548413962580221979739404493185430876269646739126718281667930329337975469259720262570335263149961516991625402462913574876404267584350037763006472002439156665085828134136535590154552915308032844709512849647895372139076879967156825351280796766455118936470166268851280218356166618692489); _sage_const_28236892415595046725432591582388828732416474617905064569072122607754608770858524128459041372057071484270512435379564707201646196605888190771514502062588889296462571293965303631814413972794037039818240294131503603586495979286695360443876197595427821630346568206817707758056914985221699475020079468223859640882426554180735136691398762626736322188857 = Integer(28236892415595046725432591582388828732416474617905064569072122607754608770858524128459041372057071484270512435379564707201646196605888190771514502062588889296462571293965303631814413972794037039818240294131503603586495979286695360443876197595427821630346568206817707758056914985221699475020079468223859640882426554180735136691398762626736322188857); _sage_const_4460221335807458477042675161977694245705812951787447010375907795667815924423737315819155047810229936553551547902212658413852207698273756133750036643420619202936829404810266733211702835346057773535936735505238954856093894601156679699379151922763828732104003886929389298150377368692252660913137361614527127508131132155154479609246257281016762062532 = Integer(4460221335807458477042675161977694245705812951787447010375907795667815924423737315819155047810229936553551547902212658413852207698273756133750036643420619202936829404810266733211702835346057773535936735505238954856093894601156679699379151922763828732104003886929389298150377368692252660913137361614527127508131132155154479609246257281016762062532); _sage_const_9201781043460359980556736117842861663276628290538343917065251888750915457628232836059030768862821918167214946309194223136118683112646124021994617507928613557060975239991467715822651626131764825372264324651760554489416182765762773870509976861438604756254575907903317539170772335286071120924262650968951658702986000783206120009060281648755307818924 = Integer(9201781043460359980556736117842861663276628290538343917065251888750915457628232836059030768862821918167214946309194223136118683112646124021994617507928613557060975239991467715822651626131764825372264324651760554489416182765762773870509976861438604756254575907903317539170772335286071120924262650968951658702986000783206120009060281648755307818924); _sage_const_5543937077544350044996092309333123896673249289133421571501770411774754485080762341808014728031466788357672378562890332413831841816913393781871311185749488571196344227579880684889257388342495218625580824438899176508588347818838888483699956781693552250914154370013716059494869453081747142733238870051446785743916715988156263290148837617938145037769 = Integer(5543937077544350044996092309333123896673249289133421571501770411774754485080762341808014728031466788357672378562890332413831841816913393781871311185749488571196344227579880684889257388342495218625580824438899176508588347818838888483699956781693552250914154370013716059494869453081747142733238870051446785743916715988156263290148837617938145037769); _sage_const_22987914183621654128340604411867934942267052582550280848285957846018953101302381781149878109130722646016565872712028557790007033084958343453481077794858006281063166771073735467680941256462722381850222939200224945915096516150903599139400592917830527158385866380698836489384576330751153207566246611430535423165552242842248141366714787814087024611125 = Integer(22987914183621654128340604411867934942267052582550280848285957846018953101302381781149878109130722646016565872712028557790007033084958343453481077794858006281063166771073735467680941256462722381850222939200224945915096516150903599139400592917830527158385866380698836489384576330751153207566246611430535423165552242842248141366714787814087024611125); _sage_const_21234494877002450963049081642653481186960620181793167754646236727226367680572479473640458132277922251388791100024511199601583510837402924852920481053211095697922161643276237988551688486352397167771672491785589777050112145285931402208676638922843629979479647525901610461142873939346359492281709510857453155957212135177425820755216349664649501012151 = Integer(21234494877002450963049081642653481186960620181793167754646236727226367680572479473640458132277922251388791100024511199601583510837402924852920481053211095697922161643276237988551688486352397167771672491785589777050112145285931402208676638922843629979479647525901610461142873939346359492281709510857453155957212135177425820755216349664649501012151); _sage_const_0 = Integer(0); _sage_const_128 = Integer(128); _sage_const_126 = Integer(126); _sage_const_99 = Integer(99); _sage_const_1 = Integer(1); _sage_const_114 = Integer(114); _sage_const_2 = Integer(2); _sage_const_121 = Integer(121); _sage_const_3 = Integer(3); _sage_const_112 = Integer(112); _sage_const_4 = Integer(4); _sage_const_116 = Integer(116); _sage_const_5 = Integer(5); _sage_const_111 = Integer(111); _sage_const_6 = Integer(6); _sage_const_123 = Integer(123); _sage_const_125 = Integer(125); _sage_const_120 = Integer(120); _sage_const_140 = Integer(140); _sage_const_200 = Integer(200); _sage_const_100 = Integer(100); _sage_const_150 = Integer(150); _sage_const_7 = Integer(7); _sage_const_10 = Integer(10); _sage_const_20 = Integer(20); _sage_const_8 = Integer(8); _sage_const_127 = Integer(127)# DGHV Approximate GCD Solver
# Paste this entire code into https://sagecell.sagemath.org/

# Ciphertexts from challenge
c = [
    _sage_const_21634731856933003169735452642178647637508232926922639676417356091816977384471672689376249580882757193930156301128940033054503309042859139845611437945134986092564611616108745009303518009598387151910455366467043039032355947377344618722993521508853304193548247098646435210196424079656513689544721371174220499686568082989950728581977777849180352180361 ,
    _sage_const_10896149947527935553077825816622071364973077548678022351082205110263626546375424477280956382311102704844299225555502875124702037214663686104873121921542353070322911926560931344323844350198967094409239865012314649708602461432807766153010660935060416997124464209447069508459786601387021215440723355335011507118508146962533432224040439243286229360126 ,
    _sage_const_2974416605206632431332911613301389081536576066459780075624719210553112019999381574735539815564432577560946864927142562117883991071103197295583373508765877145059608994024896240420251219074181316054055755363381932049698101539315448832805529921046278129220365145460609570363992617560153978334998412088660368201330429546380177743790566702908212443160 ,
    _sage_const_28200548108675594741711127688647173118542383318189251577841958615857415552524747877792302265008776748051982781254674600116918516567783637204844268842440264001368201200545979748997113084793324277575876376294203222951895428314196786131217183329046875244460729983604815969807535725100587998553238491135713196074852524738775442553590229121625915430429 ,
    _sage_const_27660084559884990182013459957689417397713852464666220341426520872184059171674750770957688936767277417745636106116299261474623004314209285327151916105808226871648486979149690145371455816243023069737489716360204808432361263273679301359983930552697681320318161922577591380052338021611137684073918689934623997444986709421563535513572520613268123359158 ,
    _sage_const_20119475249162077416396857638627557747581212727911731929838730735042026922648350211354670538277728861548055740933004923747258462839704684057991194187013090441791415402300040364180884606823323138809105421545127016753613657687973221091519628359096716460656580868946574075573069978817526799571787512906522188251790664748517306152235744590642923407030 ,
    _sage_const_9277710388163094622638132620493076418943086548508776627822589112756821030770943458707342557838944497462173121423514249639208397257763673087133572464166054442803457949072685473390496187502360398640358905886089248930227038534407158700636473552411298647208459527921849668664236361489551764643720805304784463451436299579798872023267551081752293342602 ,
    _sage_const_31158045977124269135407602181143656602962158545302579362536446823604840518596119753005295977785809341913045532725240349545539969280653140519414628705187132022321389751428727439079243486439117780734082395751447709645236914447281361619769421080744636729959026500210605864515201694830145111407222590251128832957172231813701395706417354758554315626820 ,
    _sage_const_12055966498208922749084355341317455190065977555930326942190470900499710573397286364597785100102658626097154819494365498065452378904589114960059048398023883917554704026832949307191108288334714871854358976503390510343938466659425227647536427580196701935422718990031197769681866481080518026804185304311437027704081241119520019740912986972955608893278 ,
    _sage_const_17767102403193202218304699442431662915115000676720318662325347222565131380379182512128854589956743252072881997745083910037035908185085681529637286746328665909791274494229763608885145122640713958013701818219726053389611973156883147796462512131639518714837170414174586570308340181287544747042490023777223079740383799985094123384216016337525460261356 ,
    _sage_const_6979962672620946147919479608753963248551040648763556914009797078823702868338326269303097713924542946353805294572432317526815669729810518545845862740405319661886528745990666800133027458170688035469999979423509823797849460135768432746502510169283956355180475841044794790275513292333641598671173540633541912640750930419720753655927399240016666928184 ,
    _sage_const_968567188384602518810627932191890143098667694867203398334134968321028429873726916771512992699613773685562527659911443971269281991870703578160884591545053062755617135892855613023377866271402771406594459830004948687855655933540881347294224484016294356462959434533523237665848042117796037893185022070544050577845529425854753569769243925082186348425 ,
    _sage_const_10804728490972629839599688863419012806514649061220912296135529003539879219079527649729698231657469439519564306737249244230105667024389629639509680649295767296583887032523679565132779403935606718429552343516241547007009490112830748960665135338550271076674383315260470807816736729834782534909218344628077421424202840026186555433845798422403022121746 ,
    _sage_const_12498485841654082927729391332000176077659445321198357998147011067836907101875662377570700406780396596702209507929935292024871538370717484655020356103692818360512792947022456138114688306425559505127082381521905818319542160425873904602554462539850913289414272261611285708108946736990501473240873425025495477923958515790610331967148138452382936603218 ,
    _sage_const_15122648432351787708910306624658313472637182521203794932014123051222289899019244470866928921239021804842452628277451525745197770636443191364340973030646677140509931467075316189841308905554392194260607580568566230777907627266848011866303687272754202404316594585444944269571620462990956234986783265518586377149743362292802293436359418534788251556161 ,
    _sage_const_9390969394140749476608257433637980673038793322877784368488394016568066689122081069467764942062767788295165134446781957798192761040267482593446509285966506710250967465155863626183550169814440998827518143373614753079092718069730432284965599249191929694847006205594924579123016195982524862267549617396581868514010670808145661503083427477788852007310 ,
    _sage_const_3448120089990058648942506124720802559054287900853595928077413267121845853562240438661071849842739096744542360729856930336959306909786071164994924424227597472810030437315793269469209107626604058418914579865114596569805471044423406753603841793865685790424201472892556200956939191504704829837076185223586663769678271230786398186628579741896694763290 ,
    _sage_const_18346984788037097313933208211401593831381142486125949187310810719353452435960066367300400122474012758772901379594817743384150758266673403964797768097710409271197754019777606678300159841222437507303036990181586991277543643752497915914368855739662665349654824457220475752835093086231999524281968766631421793059375831672491945304978438858273609843862 ,
    _sage_const_15536226637285228918258369477325177614750622602365663744612630206655934882232943767418215956866017370265704925268062220229799980544347921306584673132700797772216224464594472779976277574740799882055824944919096492605353410260479055271080577804638750314986246739945093908640859610936039728098902317648534567457516922705899992411565397747984639373641 ,
    _sage_const_7390421955858946980520324391197648428519742542542180214649313755976167028731434527467516638743761149905206141784824025881109303022940936016663976767507286762461144532635141193737153752852837662949732990422844329896494169995959023121814560566954151943130502828298613554945495095777393937554865091153424594585002558590468988138213857560541279869379 ,
    _sage_const_112425769870463756578217089225356135328048119859480667962834597449680068602100943466981454518737872915541357211292040696818117602877944971282329119425722152594954465048523912850046328259179463209276175774654633020669939217778876585080281354592084141796995567487319604036168491764793360083660437033644270113271674756316467223785525162737617978324 ,
    _sage_const_14347539756149650174830723100234123374889869526922875679139996993685445445424223671192352937444702312667961596673837164454053204749694354027439552310839338758036132687049417439430104024109309773483398069943055157750606445278793355305121294707158877524719404973030888356254655064096763353962301655730593591467233925869661593303855448059155282216743 ,
    _sage_const_208801597989499293183806750430428348227754832674422753135296252264260064196215293461261054323859098384083896680527340703676125325162028371333562570477104250816805754783624928526323765509312788420195828206450972283160628389270035698781630799270799491345783045145344965977841131336236262613204299016584603298281389366882657789147781311329063347318 ,
    _sage_const_22833162166359546411724656286023136808995433306442236496006005058375986840061424886144757824911202832922228870863654053366054841239665760330228843814383761504457204209161144276494315317663889626543158797934444747362649948195452867353178757072695264078834255164965304924320430338289357222851915434376663414195354820768778950790299361186797669685845 ,
    _sage_const_31062637879976203219848680788625459931640372465710164935246301671408043653722612043640281575569140157976904578152151070872082575131681817502508001911337557287758449509185833075365323885637346785285590009679703265939177832920087505472236166486790773064989776631541810613488268406348080905611001308366302641990879414342541856115781757850402335170059 ,
    _sage_const_17988613074740201689589468687659306312690117614826684863597618561450102878110879882811172597408662493899887430064607954837804338369490512526074587514414097978832086598281565708550985634159994858239903349946604781597238802158566721785968741295329861310102549624225945030480597188499641893374152661524898440766955287008666827803327359643522700462744 ,
    _sage_const_1156011452003477216703794623187783705084864796533399286057162639813836917463879542752819638295306697549486063876018432666789515496552835507994733128345081757389910447481999426686574891632359918562919770610266438217783289633061584953375493517689845599384734501508935942206029649313828593393464817909340959448946736347052497186319345289140586216133 ,
    _sage_const_15131763737808936003204137072188410323796446534725965923549717751710772316269463896669835538341947154002338825596535234163516609928932518511266230816390571037926544423386287941598776311481017054600577225406091154789797481613532626171211962510429920759067451778809797719815469811660328643189777652766031261042904687711358896144374397480643638074496 ,
    _sage_const_2683625879777439052129384625517759288806489980533997491814393250166792474776733383216232130383232280811385051710200597135982258193684031753497695563630145320773844741439765259217702400601542482014686895250894592079589773519487223465866199176146638204588836709356949746937034656669802485231742485402576922520335743224943519092403672383686297621981 ,
    _sage_const_23976878327379595750161358441759880249973515045738547387900168280548413962580221979739404493185430876269646739126718281667930329337975469259720262570335263149961516991625402462913574876404267584350037763006472002439156665085828134136535590154552915308032844709512849647895372139076879967156825351280796766455118936470166268851280218356166618692489 ,
    _sage_const_28236892415595046725432591582388828732416474617905064569072122607754608770858524128459041372057071484270512435379564707201646196605888190771514502062588889296462571293965303631814413972794037039818240294131503603586495979286695360443876197595427821630346568206817707758056914985221699475020079468223859640882426554180735136691398762626736322188857 ,
    _sage_const_4460221335807458477042675161977694245705812951787447010375907795667815924423737315819155047810229936553551547902212658413852207698273756133750036643420619202936829404810266733211702835346057773535936735505238954856093894601156679699379151922763828732104003886929389298150377368692252660913137361614527127508131132155154479609246257281016762062532 ,
    _sage_const_9201781043460359980556736117842861663276628290538343917065251888750915457628232836059030768862821918167214946309194223136118683112646124021994617507928613557060975239991467715822651626131764825372264324651760554489416182765762773870509976861438604756254575907903317539170772335286071120924262650968951658702986000783206120009060281648755307818924 ,
    _sage_const_5543937077544350044996092309333123896673249289133421571501770411774754485080762341808014728031466788357672378562890332413831841816913393781871311185749488571196344227579880684889257388342495218625580824438899176508588347818838888483699956781693552250914154370013716059494869453081747142733238870051446785743916715988156263290148837617938145037769 ,
    _sage_const_22987914183621654128340604411867934942267052582550280848285957846018953101302381781149878109130722646016565872712028557790007033084958343453481077794858006281063166771073735467680941256462722381850222939200224945915096516150903599139400592917830527158385866380698836489384576330751153207566246611430535423165552242842248141366714787814087024611125 ,
    _sage_const_21234494877002450963049081642653481186960620181793167754646236727226367680572479473640458132277922251388791100024511199601583510837402924852920481053211095697922161643276237988551688486352397167771672491785589777050112145285931402208676638922843629979479647525901610461142873939346359492281709510857453155957212135177425820755216349664649501012151 ,
]

print(f"Loaded {len(c)} ciphertexts")
print(f"First ciphertext: {c[_sage_const_0 ].nbits()} bits")

N = _sage_const_128   # Modulus used for FLAG encryption
noise_bits = _sage_const_126   # Approximate upper bound on noise

# Known prefix/suffix for crypto{...} format
known = [(_sage_const_0 , _sage_const_99 ), (_sage_const_1 , _sage_const_114 ), (_sage_const_2 , _sage_const_121 ), (_sage_const_3 , _sage_const_112 ), (_sage_const_4 , _sage_const_116 ), (_sage_const_5 , _sage_const_111 ), (_sage_const_6 , _sage_const_123 ), (-_sage_const_1 , _sage_const_125 )]

# Method 1: Orthogonal Lattice
def orthogonal_lattice_attack(cts, num=_sage_const_6 ):
    """
    Build orthogonal lattice and run LLL
    """
    n = min(num, len(cts))
    c0 = cts[_sage_const_0 ]
    K = _sage_const_2 **noise_bits
    
    M = matrix(ZZ, n, n)
    M[_sage_const_0 , _sage_const_0 ] = K
    for i in range(_sage_const_1 , n):
        M[_sage_const_0 , i] = cts[i]
        M[i, i] = -c0
    
    print(f"Running LLL on {n}x{n} orthogonal lattice...")
    L = M.LLL()
    
    candidates = []
    for row in L:
        for entry in row:
            if entry != _sage_const_0 :
                g = gcd(c0, abs(entry))
                if g > _sage_const_1  and _sage_const_120  <= g.nbits() <= _sage_const_140 :
                    candidates.append(g)
    
    return candidates

# Method 2: Using known plaintext
def known_plaintext_attack(cts, known_pairs):
    """
    Use known plaintext positions to construct better lattice
    """
    # Adjust ciphertexts by subtracting known plaintext
    adjusted = []
    for pos, char in known_pairs:
        idx = pos if pos >= _sage_const_0  else len(cts) + pos
        adjusted.append(cts[idx] - char)
    
    n = len(adjusted)
    K = _sage_const_2 **(noise_bits + _sage_const_5 )
    
    # Build lattice
    M = matrix(ZZ, n+_sage_const_1 , n+_sage_const_1 )
    M[_sage_const_0 , _sage_const_0 ] = K
    for i in range(n):
        M[i+_sage_const_1 , _sage_const_0 ] = adjusted[i]
        M[i+_sage_const_1 , i+_sage_const_1 ] = _sage_const_1 
    
    print(f"Running LLL on {n+_sage_const_1 }x{n+_sage_const_1 } known-plaintext lattice...")
    L = M.LLL()
    
    candidates = []
    for row in L:
        val = row[_sage_const_0 ]
        if val != _sage_const_0  and abs(val).nbits() < _sage_const_200 :
            g = gcd(cts[_sage_const_0 ], abs(val))
            if g > _sage_const_1  and _sage_const_100  <= g.nbits() <= _sage_const_150 :
                candidates.append(g)
    
    return candidates

# Method 3: Simultaneous Diophantine Approximation
def sda_attack(cts, num=_sage_const_7 ):
    """
    Use SDA-based lattice for approximate GCD
    """
    n = min(num, len(cts))
    
    # Reference: Chen-Nguyen's orthogonal lattice attack
    # We want short vector (1, x_1, ..., x_{n-1}) such that
    # c_0 + x_1*c_1 + ... + x_{n-1}*c_{n-1} is small (divisible by p)
    
    K = _sage_const_2 **(noise_bits + _sage_const_10 )
    
    M = matrix(ZZ, n, n)
    for i in range(n):
        M[i, _sage_const_0 ] = cts[i]
        if i > _sage_const_0 :
            M[i, i] = K
    M[_sage_const_0 , _sage_const_0 ] = cts[_sage_const_0 ] * K
    
    print(f"Running BKZ on {n}x{n} SDA lattice...")
    # Try BKZ for better reduction
    try:
        L = M.BKZ(block_size=min(_sage_const_20 , n))
    except:
        L = M.LLL()
    
    candidates = []
    for row in L:
        val = row[_sage_const_0 ]
        if val != _sage_const_0 :
            g = gcd(cts[_sage_const_0 ], abs(val))
            if g > _sage_const_1  and _sage_const_100  <= g.nbits() <= _sage_const_150 :
                candidates.append(g)
    
    return candidates

# Method 4: Difference-based lattice
def diff_lattice_attack(cts, num=_sage_const_8 ):
    """
    Use differences between ciphertexts
    """
    n = min(num, len(cts))
    c0 = cts[_sage_const_0 ]
    
    # d_i = c_0 - c_i = p*(q_0 - q_i) + (e_0 - e_i)
    diffs = [c0 - cts[i] for i in range(_sage_const_1 , n)]
    
    m = len(diffs)
    K = _sage_const_2 **(noise_bits + _sage_const_3 )
    
    M = matrix(ZZ, m+_sage_const_1 , m+_sage_const_1 )
    M[_sage_const_0 , _sage_const_0 ] = K
    for i in range(m):
        M[i+_sage_const_1 , _sage_const_0 ] = diffs[i]
        M[i+_sage_const_1 , i+_sage_const_1 ] = _sage_const_1 
    
    print(f"Running LLL on {m+_sage_const_1 }x{m+_sage_const_1 } difference lattice...")
    L = M.LLL()
    
    candidates = []
    for row in L:
        val = row[_sage_const_0 ]
        if val != _sage_const_0 :
            g = gcd(c0, abs(val))
            if g > _sage_const_1  and _sage_const_100  <= g.nbits() <= _sage_const_150 :
                candidates.append(g)
    
    return candidates

# Run all attacks
print("\n=== Running Lattice Attacks ===\n")

all_candidates = set()

print("Attack 1: Orthogonal Lattice")
cands1 = orthogonal_lattice_attack(c, num=_sage_const_6 )
for x in cands1:
    if is_prime(x):
        all_candidates.add(x)
        print(f"  Found prime: {x.nbits()} bits")

print("\nAttack 2: Known Plaintext")
cands2 = known_plaintext_attack(c, known)
for x in cands2:
    if is_prime(x):
        all_candidates.add(x)
        print(f"  Found prime: {x.nbits()} bits")

print("\nAttack 3: SDA")
cands3 = sda_attack(c, num=_sage_const_7 )
for x in cands3:
    if is_prime(x):
        all_candidates.add(x)
        print(f"  Found prime: {x.nbits()} bits")

print("\nAttack 4: Difference Lattice")
cands4 = diff_lattice_attack(c, num=_sage_const_8 )
for x in cands4:
    if is_prime(x):
        all_candidates.add(x)
        print(f"  Found prime: {x.nbits()} bits")

print(f"\n=== Total unique prime candidates: {len(all_candidates)} ===\n")

# Try decryption
def verify_and_decrypt(p, cts, mod=_sage_const_128 ):
    # Verify noise is reasonable
    for ct in cts[:_sage_const_5 ]:
        if ct % p > _sage_const_2 **_sage_const_127 :
            return None
    
    # Decrypt
    flag = ""
    for ct in cts:
        m = (ct % p) % mod
        if _sage_const_0  <= m < _sage_const_128 :
            flag += chr(m)
        else:
            flag += "?"
    
    return flag

for p in all_candidates:
    print(f"Testing p = {p} ({p.nbits()} bits)")
    flag = verify_and_decrypt(p, c)
    if flag:
        print(f"Decrypted: {flag}")
        if flag.startswith("crypto{"):
            print(f"\n*** FLAG FOUND: {flag} ***")
            break
    else:
        print("  Failed verification")

print("\nDone!")

